<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
	crossorigin="anonymous">
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
	integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
	crossorigin="anonymous"></script>
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">

<Script>
document.addEventListener("DOMContentLoaded", function() {

	const  goListEl  = document.getElementById('btn-list');
     goListEl.addEventListener('click', function(e) {
        location.href = '/main'
     })

	document.getElementById("btn-cancel").addEventListener("click",
			function() {
		   document.getElementById("post_title").value = "";
	        document.getElementById("post_contents").value = "";
			});
});
</Script>
</head>
<body>
	<main class="container mt-5">
		<div class="row">
			<div class="col-sm">
				<form action="/write" method="post" enctype="multipart/form-data">
					<input type="hidden" name="post_id" th:value="${user.user_id}" />
					<input type="hidden" name="post_name" th:value="${user.user_name}" />
					<div class="form-floating my-3">
						<input type="text" class="form-control" name="post_title"
							id="post_title" /> <label for="post_title">글 제목</label>
					</div>

					<div class="form-floating my-3">
						<textarea rows="20" class=" form-control" id="post_contents"
							name="post_contents" style="height: 250px; width: 100%;"></textarea>
						<label for="post_contents">내용</label>
					</div>
					<div class="my-3 clearfix">
						<label class="btn" for="images"> <i
							class="bi bi-card-image fs-1"></i></label> <input type="file"
							class="form-control" id="images" name="images" multiple
							style="display: none;"> <span id="file-names"
							class="text-muted">선택된 파일 없음</span>
						<button type="button" id="btn-list"
							class="btn btn-secondary float-start">목록</button>
						<button type="reset" id="btn-reset"
							class="btn btn-warning float-end">리셋</button>
						<button type="submit" id="btn-submit"
							class="btn btn-primary float-end me-2">등록</button>
					</div>
				</form>
			</div>
		</div>
	</main>
</body>
<script>
  const area = document.querySelector("#post_contents");

  // 키 다운 이벤트를 통해 localStorage에 내용 저장
  area.addEventListener("input", () => {
    console.log(area.value);
      });
  window.addEventListener("beforeunload", () => {
	    localStorage.setItem("textArea", area.value);
	  });
  // 페이지 로드 시 localStorage에서 내용 불러오기
  window.onload = () => {
    if (localStorage.getItem("textArea")) {
      if (confirm("최근 작성한 글을 불러오시겠습니까?")) {
        console.log(localStorage.getItem("textArea"));
        // .area 대신 #content를 사용하고, innerText 대신 value를 사용
        document.querySelector("#post_contents").value = localStorage.getItem("textArea");
      } else {
        localStorage.removeItem("textArea");
      }
    }
  };
</script>
<script>
document.getElementById('images').addEventListener('change', function() {
    var files = this.files;
    var fileNames = [];
    for (var i = 0; i < files.length; i++) {
        fileNames.push(files[i].name);
    }

    var displayText = fileNames.join(', ');
    if (displayText === '') {
        displayText = '선택된 파일 없음';
    }

    document.getElementById('file-names').innerText = displayText;
});
</script>
</html>